/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/wrappers/record_video.py:94: UserWarning: [33mWARN: Overwriting existing videos at /Users/oyvind/code/skole/master/rl-test/videos/ppo-mountain-car-continuous folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)
  logger.warn(
SPS: 5
SPS: 7
SPS: 7
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 8
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
SPS: 9
t:   0%|                                                                                                                                                                                                        | 0/1001 [00:00<?, ?it/s, now=None]Traceback (most recent call last):
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/moviepy/video/io/ffmpeg_writer.py", line 136, in write_frame
    self.proc.stdin.write(img_array.tobytes())
BrokenPipeError: [Errno 32] Broken pipe
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/Users/oyvind/code/skole/master/rl-test/mountain_car.py", line 159, in <module>
    next_obs, reward, done, truncated, info = envs.step(action.cpu().numpy())
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/vector/vector_env.py", line 204, in step
    return self.step_wait()
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/vector/sync_vector_env.py", line 149, in step_wait
    ) = env.step(action)
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/core.py", line 555, in step
    observation, reward, terminated, truncated, info = self.env.step(action)
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/wrappers/normalize.py", line 143, in step
    obs, rews, terminateds, truncateds, infos = self.env.step(action)
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/core.py", line 522, in step
    observation, reward, terminated, truncated, info = self.env.step(action)
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/wrappers/normalize.py", line 81, in step
    obs, rews, terminateds, truncateds, infos = self.env.step(action)
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/core.py", line 591, in step
    return self.env.step(self.action(action))
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/wrappers/record_video.py", line 191, in step
    self.close_video_recorder()
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/wrappers/record_video.py", line 204, in close_video_recorder
    self.video_recorder.close()
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/wandb/integration/gym/__init__.py", line 65, in close
    recorder.orig_close(self)
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/gymnasium/wrappers/monitoring/video_recorder.py", line 157, in close
    clip.write_videofile(self.path, logger=moviepy_logger)
  File "<decorator-gen-51>", line 2, in write_videofile
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/moviepy/decorators.py", line 54, in requires_duration
    return f(clip, *a, **k)
  File "<decorator-gen-50>", line 2, in write_videofile
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/moviepy/decorators.py", line 135, in use_clip_fps_by_default
    return f(clip, *new_a, **new_kw)
  File "<decorator-gen-49>", line 2, in write_videofile
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/moviepy/decorators.py", line 22, in convert_masks_to_RGB
    return f(clip, *a, **k)
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/moviepy/video/VideoClip.py", line 300, in write_videofile
    ffmpeg_write_video(self, filename, fps, codec,
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/moviepy/video/io/ffmpeg_writer.py", line 228, in ffmpeg_write_video
    writer.write_frame(frame)
  File "/Users/oyvind/code/skole/master/rl-test/.venv/lib/python3.10/site-packages/moviepy/video/io/ffmpeg_writer.py", line 180, in write_frame
    raise IOError(error)
OSError: [Errno 32] Broken pipe
MoviePy error: FFMPEG encountered the following error while writing file /Users/oyvind/code/skole/master/rl-test/videos/ppo-mountain-car-continuous/rl-video-episode-0.mp4:
 b"dyld[5451]: Library not loaded: /opt/homebrew/opt/mbedtls/lib/libmbedcrypto.14.dylib\n  Referenced from: <2A51F80F-874A-3D40-87C1-BEDE8979EC7A> /opt/homebrew/Cellar/librist/0.2.7_3/lib/librist.4.dylib\n  Reason: tried: '/opt/homebrew/opt/mbedtls/lib/libmbedcrypto.14.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OS/opt/homebrew/opt/mbedtls/lib/libmbedcrypto.14.dylib' (no such file), '/opt/homebrew/opt/mbedtls/lib/libmbedcrypto.14.dylib' (no such file), '/usr/local/lib/libmbedcrypto.14.dylib' (no such file), '/usr/lib/libmbedcrypto.14.dylib' (no such file, not in dyld cache), '/opt/homebrew/Cellar/mbedtls/3.5.0/lib/libmbedcrypto.14.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OS/opt/homebrew/Cellar/mbedtls/3.5.0/lib/libmbedcrypto.14.dylib' (no such file), '/opt/homebrew/Cellar/mbedtls/3.5.0/lib/libmbedcrypto.14.dylib' (no such file), '/usr/local/lib/libmbedcrypto.14.dylib' (no such file), '/usr/lib/libmbedcrypto.14.dylib' (no such file, not in dyld cache)\n"
SPS: 9
Moviepy - Building video /Users/oyvind/code/skole/master/rl-test/videos/ppo-mountain-car-continuous/rl-video-episode-0.mp4.
Moviepy - Writing video /Users/oyvind/code/skole/master/rl-test/videos/ppo-mountain-car-continuous/rl-video-episode-0.mp4